// ===== CONFIG =====
const TOTAL_SCENARIOS = 5;
const MAX_SCORE_PER_SCENARIO = 100;

// ===== STATE =====
let currentScenario = 0;
let totalScore = 0;

// ===== DOM ELEMENTS =====
const nextBtn = document.getElementById("nextBtn");
const scoreEl = document.getElementById("score");
const scenarioEl = document.getElementById("scenario");
const resultEl = document.getElementById("finalResult");

// ===== SCORING =====
function addScore(points) {
  totalScore += points;
  scoreEl.textContent = `${totalScore} / ${TOTAL_SCENARIOS * MAX_SCORE_PER_SCENARIO}`;
}

// ===== NAVIGATION =====
nextBtn.addEventListener("click", () => {
  if (currentScenario < TOTAL_SCENARIOS - 1) {
    currentScenario++;
    loadScenario(currentScenario);

    if (currentScenario === TOTAL_SCENARIOS - 1) {
      nextBtn.textContent = "See Your Final Twist Badge";
    }
  } else {
    showFinalResult();
  }
});

// ===== SCENARIO LOADER =====
function loadScenario(index) {
  scenarioEl.textContent = `Scenario ${index + 1}`;
}

// ===== FINAL RESULT =====
function showFinalResult() {
  nextBtn.style.display = "none";
  scenarioEl.style.display = "none";

  const badge = getBadge(totalScore);

  resultEl.innerHTML = `
    <div class="badge">
      <h2>${badge.icon} ${badge.title}</h2>
      <p>${badge.text}</p>
      <strong>Your Twist Score: ${totalScore} / 500</strong>
      <p class="note">Just like real conversations, this was one take only.</p>
    </div>
  `;

  resultEl.style.display = "block";
}

// ===== BADGE LOGIC =====
function getBadge(score) {
  if (score === 500) {
    return {
      icon: "ðŸ§ª",
      title: "The Alchemist",
      text: "You turned every spark into connection. Legend behavior."
    };
  }
  if (score >= 400) {
    return {
      icon: "ðŸŒ€",
      title: "The Twist Master",
      text: "Empathy, clarity, and timing â€” dangerous combo."
    };
  }
  if (score >= 300) {
    return {
      icon: "ðŸ§­",
      title: "The Clear Communicator",
      text: "You say what you mean. Now add more twist."
    };
  }
  if (score >= 200) {
    return {
      icon: "ðŸ§Š",
      title: "The Polite Wall",
      text: "Professional, correct â€” emotionally bulletproof."
    };
  }
  return {
    icon: "ðŸ§¨",
    title: "The Unfiltered Reactor",
    text: "Fast reactions. Twists still loading."
  };
}

// ===== REFRESH WARNING =====
window.addEventListener("beforeunload", (e) => {
  e.preventDefault();
  e.returnValue = "";
});
